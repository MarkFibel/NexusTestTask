# NexusTestTask

## Задание: Классификация текстовых документов

### Описание
Имеется набор текстовых документов, разделённых на классы по их семантике. Документы могут быть организованы в директориях, соответствующих их классам. Количество классов может изменяться: добавляться новые или удаляться существующие. Необходимо разработать классификатор, способный определять класс нового документа на основе его содержания.

### Требования
- Классификатор должен корректно работать при изменении количества классов.
- Анализ и обработка документов должны учитывать их текстовое содержание.

---

## Решение

### Ход решения задачи классификации текстов

1. **Инициализация и настройка модели**:
   - Создаётся объект `TextClassifier`, который использует предобученную модель из библиотеки Hugging Face (например, `sentence-transformers/all-MiniLM-L6-v2`) для генерации эмбеддингов текстов.
   - Устройство для выполнения вычислений определяется автоматически (GPU, MPS или CPU).

2. **Обработка текстов**:
   - Модуль `TextDataProcessor` выполняет предобработку текстов:
     - Удаляет HTML-теги и неалфавитные символы.
     - Приводит текст к нижнему регистру.
     - Удаляет стоп-слова на заданных языках (например, английский и русский).
   - Тексты токенизируются и преобразуются в эмбеддинги с помощью модели.

3. **Добавление обучающих данных**:
   - Метод `add_to_training_data` добавляет новые тексты и их метки в обучающий набор. Эмбеддинги текстов сохраняются в `KNNClassifier`.
   - Новые классы добавляются в список классов (`class_names`), если они ещё не существуют.

4. **Обучение KNN-классификатора**:
   - KNN-классификатор (`KNNClassifier`) хранит эмбеддинги и метки классов.
   - Для каждого нового текста вычисляются ближайшие соседи на основе косинусного расстояния.
   - Если расстояние до ближайшего соседа превышает заданный порог (`threshold`), текст классифицируется как "неизвестный класс".

5. **Классификация текстов**:
   - Метод `predict` преобразует входные тексты в эмбеддинги и предсказывает их классы, используя KNN.
   - Если метка предсказана как "неизвестный класс", возвращается `'unknown'`.

6. **Оценка модели**:
   - Метод `evaluate` вычисляет метрики качества классификации:
     - Accuracy
     - F1-Score
     - Precision
     - Recall
     - Balanced Accuracy
   - Истинные метки кодируются с помощью `LabelEncoder` для совместимости с KNN.

7. **Сохранение и загрузка модели**:
   - Метод `save_model` сохраняет состояние модели, список классов и эмбеддинги.
   - Метод `load_model` загружает ранее сохранённое состояние.

8. **Работа с новыми данными**:
   - Метод `load_new_documents` загружает текстовые данные из указанной директории.
   - Обучение модели может быть продолжено с новыми данными.

---

### Пример использования

```python
from TextClassifier import TextClassifier

# Инициализация классификатора
text_classifier = TextClassifier()

# Загрузка новых документов
text_classifier.load_documents('path/to/documents')

# Обучение классификатора
text_classifier.fit()

# Классификация нового документа
new_document = "Пример текста для классификации"
predicted_class = text_classifier.predict(new_document)
print(f"Класс документа: {predicted_class}")
```
